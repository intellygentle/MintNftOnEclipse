"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.write = exports.DEFAULT_CHUNK_SIZE = void 0;
const umi_1 = require("@metaplex-foundation/umi");
const write_1 = require("./generated/instructions/write");
exports.DEFAULT_CHUNK_SIZE = 850;
const write = (context, input) => {
    const payer = input.payer ?? context.payer;
    const chunkSize = input.chunkSize ?? exports.DEFAULT_CHUNK_SIZE;
    const bufferSize = input.data.length;
    const numberOfWrites = Math.ceil(bufferSize / chunkSize);
    const writeInstructions = Array.from({ length: numberOfWrites }, (_, index) => {
        const slice = input.data.slice(index * chunkSize, Math.min((index + 1) * chunkSize, input.data.length));
        return (0, write_1.write)(context, {
            asset: input.asset,
            payer,
            bytes: slice,
            overwrite: index === 0,
        });
    });
    return (0, umi_1.transactionBuilderGroup)((0, umi_1.transactionBuilder)()
        .add(writeInstructions)
        .unsafeSplitByTransactionSize(context)).sequential();
};
exports.write = write;
//# sourceMappingURL=write.js.map